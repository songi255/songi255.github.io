---
layout: post
title: 현재 실행중인 함수명 얻기
description:
img_path: "/assets/img"
image:
  lqip:
  path:
  alt:
pin: false
categories: [Java, tips]
tags: Java
---

Java에서 실행중인 함수명을 얻는 방법을 정리해보았습니다.
각각의 방법은 장단점이 있으니, 상황에 따라 알맞게 사용하길 권장합니다.

## 1. StackTrace 사용

### 1-1. StackWalker(java9+) 사용

제일 권장하는 방법입니다. 이유는 Call Stack을 사용하기 때문에 가장 직관적이고 유연합니다.

java9의 StackWalker를 사용합니다. Lazy 방식이기 때문에 오버헤드가 크지 않습니다.

```java

// find first 주석 추가
```

구현코드를 통해 알 수 있지만, skip을 1로 조정하고 유틸리티 함수로 뺄 수 있습니다.

심지어 stream 사용하기 때문에, filtering 도 가능합니다.

매우 유연합니다.

### 1-2. Thread 사용

```java
/**
 * Get the method name for a depth in call stack. <br />
 * Utility function
 * @param depth depth in the call stack (0 means current method, 1 means call method, ...)
 * @return method name
 */
public static String getMethodName(final int depth)
{
  final StackTraceElement[] ste = Thread.currentThread().getStackTrace();

  //System. out.println(ste[ste.length-depth].getClassName()+"#"+ste[ste.length-depth].getMethodName());
  // return ste[ste.length - depth].getMethodName();  //Wrong, fails for depth = 0
  return ste[ste.length - 1 - depth].getMethodName(); //Thank you Tom Tresansky
}
```

일부 가상 머신은 상황에 따라 스택 추적에서 하나 이상의 스택 프레임을 생략할 수 있습니다. 극단적인 경우, 이 스레드에 관한 스택 추적 정보가 없는 가상 머신은 이 메서드에서 길이가 0인 배열을 반환하는 것이 허용됩니다.

### 1-3. Exception 사용

```java
    StackTraceElement[] stackTrace = new Throwable().getStackTrace();

    assertEquals(
      "givenThrowable_whenGetStacktrace_thenFindMethod",
      stackTrace[0].getMethodName());
```

java8 이하를 사용한다면 고려해볼 수 있지만, 오버헤드가 큽니다.

## 2. Reflection 사용

```java
void myFunc() {
  String name = new Object(){}
                      .getClass().getEnclosingMethod().getName();
  ...
}
```

런타임의 익명객체 생성, 리플렉션을 이용한 방법입니다.

익명객체 생성을 기반으로 구현되기 때문에, 해당 함수에만 사용가능합니다.

## 실행시간 테스트

## References

- https://stackoverflow.com/questions/442747/getting-the-name-of-the-currently-executing-method
- https://openjdk.org/jeps/259
- https://www.baeldung.com/java-name-of-executing-method
